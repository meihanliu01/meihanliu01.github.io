---
import { siteConfig } from "../../config";

type GallerySection = {
  title: string;
  images: string[];
};

type PersonalLifeItem = {
  slug: string;
  title: string;
  description: string;
  image?: string; 
  cover?: string; 
  images?: string[]; 
  sections?: GallerySection[]; 
};

export function getStaticPaths() {
  return (siteConfig.personalLife as PersonalLifeItem[]).map((item) => ({
    params: { slug: item.slug },
    props: { item },
  }));
}

const { item } = Astro.props as { item: PersonalLifeItem };
const heroSrc = item.cover ?? item.image ?? item.images?.[0];
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{item.title} | {siteConfig.name}</title>
    <meta name="description" content={item.description} />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@600;700&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <main class="wrap">
      <a class="backPill reveal" href="/" aria-label="Back to home">
        <span class="backIcon" aria-hidden="true">←</span>
        <span>Back</span>
      </a>

      <header class="head">
        <h1 class="title reveal reveal-delay-1">{item.title}</h1>

        <div class="quote reveal reveal-delay-2">
          <p class="desc">— {item.description}</p>
        </div>
      </header>

      {
        heroSrc && (
          <div class="heroWrap reveal reveal-delay-3">
            <img class="hero" src={heroSrc} alt={item.title} loading="lazy" />
          </div>
        )
      }

      {}
      {
        item.sections?.length ? (
          <section class="gallery">
            {item.sections.map((sec) => (
              <div class="sec">
                <h2 class="secTitle reveal reveal-delay-2">{sec.title}</h2>
                <div class="grid">
                  {sec.images.map((src, i) => (
                    <img
                      class="thumb reveal reveal-stagger photo-hover"
                      style={`--d:${i}`}
                      src={src}
                      alt={`${sec.title} photo`}
                      loading="lazy"
                    />
                  ))}
                </div>
              </div>
            ))}
          </section>
        ) : item.images?.length ? (
          <section class="gallery">
            <div class="grid">
              {item.images.map((src, i) => (
                <img
                  class="thumb reveal reveal-stagger photo-hover"
                  style={`--d:${i}`}
                  src={src}
                  alt={`${item.title} photo`}
                  loading="lazy"
                />
              ))}
            </div>
          </section>
        ) : null
      }
    </main>

    <style>
      :global(body) {
        margin: 0;
        font-family:
          "Inter",
          system-ui,
          -apple-system,
          sans-serif;
        color: #0f172a;
        background: #ffffff;
      }

      .wrap {
        max-width: 980px;
        margin: 0 auto;
        padding: 2.25rem 1rem 3.5rem;
      }

      .backPill {
        display: inline-flex;
        align-items: center;
        gap: 0.6rem;
        padding: 0;
        border-radius: 999px;
        text-decoration: none;
        font-weight: 700;
        color: rgba(15, 23, 42, 0.85);
        background: transparent;
        border: none;
        box-shadow: none;
        transition:
          color 180ms ease,
          transform 180ms ease;
      }

      .backIcon {
        width: 2.2rem;
        height: 2.2rem;
        border-radius: 999px;
        background: rgba(107, 33, 168, 0.12);
        color: #6b21a8;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 900;
        transition:
          background 180ms ease,
          transform 180ms ease;
      }

      .backPill:hover {
        color: #6b21a8;
      }

      .backPill:hover .backIcon {
        background: rgba(107, 33, 168, 0.2);
        transform: translateX(-2px);
      }

      .backPill:active {
        transform: translateY(0px);
        box-shadow: 0 10px 26px rgba(2, 6, 23, 0.1);
      }

      .head {
        text-align: center;
        margin: 1.15rem 0 1.25rem;
      }

      .title {
        font-family: "Playfair Display", Georgia, serif;
        font-size: 3.25rem;
        margin: 0;
        line-height: 1.05;
        letter-spacing: -0.03em;
      }

      @media (max-width: 640px) {
        .title {
          font-size: 2.6rem;
        }
      }

      .quote {
        display: flex;
        justify-content: center;
        margin-top: 0.9rem;
      }

      .desc {
        font-family: "Playfair Display", Georgia, serif;
        font-size: 1.15rem;
        line-height: 1.9;
        color: rgba(15, 23, 42, 0.65);
        margin: 0;
        max-width: 46rem;
        padding: 0;
        border: none;
        background: transparent;
      }

      .heroWrap {
        margin: 1.6rem 0 1.8rem;
      }

      .hero {
        width: 100%;
        height: 380px;
        object-fit: cover;
        border-radius: 1.25rem;
        display: block;
        box-shadow: 0 18px 50px rgba(2, 6, 23, 0.1);
      }

      @media (max-width: 640px) {
        .hero {
          height: 300px;
          border-radius: 1rem;
        }
      }

      .gallery {
        margin-top: 2.25rem;
      }

      .sec {
        margin-top: 2.2rem;
      }

      .sec:first-child {
        margin-top: 0;
      }

      .secTitle {
        font-family: "Playfair Display", Georgia, serif;
        font-size: 2.2rem;
        font-weight: 600;
        margin: 2.5rem 0 1.5rem;
        color: #0f172a;
        text-align: center;
        letter-spacing: -0.02em;
      }

      .grid {
        display: grid;
        gap: 0.85rem;
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }

      @media (max-width: 820px) {
        .grid {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }

      @media (max-width: 520px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }

      .thumb {
        width: 100%;
        height: 360px;
        object-fit: cover;
        border-radius: 0.95rem;
        display: block;
        box-shadow: 0 14px 35px rgba(2, 6, 23, 0.08);
      }

      /* ==========================
         Smooth animations
         ========================== */
      @media (prefers-reduced-motion: no-preference) {
        .reveal {
          opacity: 0;
          transform: translateY(12px);
          filter: blur(6px);
          animation: reveal 900ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .reveal-delay-1 {
          animation-delay: 120ms;
        }
        .reveal-delay-2 {
          animation-delay: 240ms;
        }
        .reveal-delay-3 {
          animation-delay: 360ms;
        }

        .reveal-stagger {
          animation-delay: calc(var(--d, 0) * 60ms + 260ms);
        }

        @keyframes reveal {
          to {
            opacity: 1;
            transform: translateY(0);
            filter: blur(0);
          }
        }

        .photo-hover {
          transition:
            transform 260ms cubic-bezier(0.16, 1, 0.3, 1),
            box-shadow 260ms cubic-bezier(0.16, 1, 0.3, 1);
          will-change: transform;
        }

        .photo-hover:hover {
          transform: translateY(-4px);
          box-shadow: 0 22px 55px rgba(2, 6, 23, 0.14);
        }
      }
    </style>
  </body>
</html>
